# a very minimal declarative config file
_format_version: "2.1"
_transform: true

services:
  - name: camera-1-service
    url: http://camera-1-service:8080/api/v1/hc
    routes:
      - name: camera-1-service-route
        paths:
          - /camera-1-service/api/v1/hc
        strip_path: true

  - name: camera-2-service
    url: http://camera-2-service:8080/api/v1/hc
    routes:
      - name: camera-2-service-route
        paths:
          - /camera-2-service/api/v1/hc
        strip_path: true

  - name: camera-3-service
    url: http://camera-3-service:8080/api/v1/hc
    routes:
      - name: camera-3-service-route
        paths:
          - /camera-3-service/api/v1/hc
        strip_path: true

  - name: camera-4-service
    url: http://camera-4-service:8080/api/v1/hc
    routes:
      - name: camera-4-service-route
        paths:
          - /camera-4-service/api/v1/hc
        strip_path: true

plugins:
  - name: prometheus
    enabled: true
    protocols:
      - grpc
      - grpcs
      - http
      - https
  - name: statsd
    service: camera-1-service
    enabled: true
    config:
      host: graphite
      port: 8125
      metrics:
        - name: request_count
          stat_type: counter
          sample_rate: 1
        - name: request_size
          stat_type: histogram
          sample_rate: 1
        - name: response_size
          stat_type: histogram
          sample_rate: 1
      prefix: statsd
  - name: basic-auth
    service: camera-1-service
    enabled: true
    config:
      hide_credentials: true
  - name: hmac-auth
    service: camera-2-service
    enabled: true
    config:
      hide_credentials: true
  - name: jwt
    service: camera-3-service
    enabled: true
  - name: key-auth
    service: camera-4-service
    enabled: true
